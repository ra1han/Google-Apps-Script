{"files":[{"id":"d2f56ac0-2c76-4251-865d-e96872513352","name":"Code","type":"server_js","source":"function CleanPromotionEmails() {    \n  var daysToKeepEmails \u003d 7;  \n  \n  var today \u003d new Date();  \n  var date \u003d today.getFullYear()+\u0027/\u0027+(today.getMonth()+1)+\u0027/\u0027+(today.getDate()-daysToKeepEmails);\n    \n  var count \u003d 0;\n  while(true){\n    var promotionThreads \u003d GmailApp.search(\u0027category:promotions has:nouserlabels !is:important !is:starred before:\u0027+date, count, 500); //searches for emails without labels which are not marked important or starred. Change this section according to your need.\n    var itemCount \u003d promotionThreads.length;\n    \n    for (var i \u003d 0; i \u003c itemCount; i++) {\n        promotionThreads[i].moveToTrash();\n    }\n    \n    count +\u003d itemCount;    \n    if(itemCount \u003c 500) break;\n  }\n  \n  if(count !\u003d 0)\n    GmailApp.sendEmail(Session.getActiveUser().getEmail(), \u0027Deleted promotion emails \u0027+count, \u0027\u0027);\n}\n\nfunction CleanSocialEmails() {    \n  var daysToKeepEmails \u003d 7;  \n  \n  var today \u003d new Date();  \n  var date \u003d today.getFullYear()+\u0027/\u0027+(today.getMonth()+1)+\u0027/\u0027+(today.getDate()-daysToKeepEmails);\n    \n  var count \u003d 0;\n  while(true){\n    var socialThreads \u003d GmailApp.search(\u0027category:social has:nouserlabels !is:important !is:starred before:\u0027+date, count, 500); //searches for emails without labels which are not marked important or starred. Change this section according to your need.\n    var itemCount \u003d socialThreads.length;\n    \n    for (var i \u003d 0; i \u003c itemCount; i++) {\n        socialThreads[i].moveToTrash();\n    }\n    \n    count +\u003d itemCount;    \n    if(itemCount \u003c 500) break;\n  }\n  \n  if(count !\u003d 0)\n    GmailApp.sendEmail(Session.getActiveUser().getEmail(), \u0027Deleted social emails \u0027+count, \u0027\u0027);\n}"}]}